{"version":3,"sources":["webpack:///./src/components-block/user/user-list.vue?4a50","webpack:///./src/views/search/Search.vue","webpack:///./src/views/search/use-play.js","webpack:///./src/views/search/Search.vue?f441","webpack:///./src/components-block/user/user-list.vue","webpack:///./src/components-block/user/user-list.vue?cedd","webpack:///./src/views/search/Search.vue?df51"],"names":["class","onFocusToInput","type","keyWord","ref","onClearKeyWord","hots","item","key","onSelectHotItem","first","isHotShow","bounce","list","searchList","onSelectItem","isLoading","store","useStore","setSongs","songs","commit","setPlayState","flag","setCurrentIndex","index","setFullScreen","getMusic","id","dispatch","getLyric","getSongDetailToId","obj","getSongDetail","ids","details","musicUrl","lyric","song","name","singer","ar","map","join","al","picUrl","parseLyric","components","UserList","Scroll","setup","inputRef","scrollRef","value","length","hotList","keywords","trim","result","refresh","focus","__exports__","render","isShowBottomBox","MiniPlayerBox","props","Array","default","Boolean","emit"],"mappings":"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","file":"js/chunk-1c40f781.2e0f7bcd.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./user-list.vue?vue&type=style&index=0&id=3c32307a&scoped=true&lang=scss\"","<template>\n  <div class='search-wrap container' v-load='isLoading'>\n    <div class='input-box' @click='onFocusToInput'>\n      <input type='text' v-model='keyWord' ref='inputRef'>\n      <i class='icon-search'></i>\n      <i class='icon-close' v-show='keyWord!==\"\"' @click.stop='onClearKeyWord'></i>\n    </div>\n    <div class='hot-word' v-show='!isHotShow'>\n      <div class='hot-item'>热门搜索</div>\n      <div class='hot-item' v-for='item in hots' :key='item' @click='onSelectHotItem(item)'>{{ item.first }}</div>\n    </div>\n    <scroll class='search-scroll-wrap container' v-if='isHotShow' :bounce='true' ref='scrollRef'>\n      <user-list :list='searchList' @select='onSelectItem'></user-list>\n    </scroll>\n  </div>\n</template>\n\n<script>\nimport Scroll from '@/components/scroll/scroll'\nimport UserList from '@/components-block/user/user-list'\nimport { computed, nextTick, ref, watch, watchEffect } from 'vue'\nimport { getHotList, getHotListToKeyWord } from '@/api'\nimport usePlay from '@/views/search/use-play'\n\nexport default {\n  name: 'Search',\n  components: {\n    UserList,\n    Scroll\n  },\n  setup() {\n    // 热门\n    const keyWord = ref('')\n    const hots = ref([])\n    const searchList = ref([])\n    const inputRef = ref(null)\n    const scrollRef = ref(null)\n    const isHotShow = computed(() => searchList.value.length !== 0)\n    const isLoading = ref(false)\n    watchEffect(async () => {\n      const hotList = await getHotList()\n      hots.value = hotList\n    })\n    // 点击热词\n    const onSelectHotItem = async (keywords) => {\n      keyWord.value = keywords.first\n    }\n    watch(keyWord, async (keywords) => {\n      if (keywords.trim() !== '') {\n        searchList.value = []\n        isLoading.value = true\n        const result = await getHotListToKeyWord({ keywords })\n        isLoading.value = false\n        searchList.value = result\n        await nextTick(() => {\n          scrollRef.value && scrollRef.value.refresh()\n        })\n      } else {\n        searchList.value = []\n      }\n    })\n    // 清空关键词\n    const onClearKeyWord = () => {\n      keyWord.value = ''\n    }\n    // 点击焦点\n    const onFocusToInput = () => {\n      inputRef.value.focus()\n    }\n    // 点击歌曲\n    const { getSongDetailToId } = usePlay()\n\n    const onSelectItem = async (id) => {\n      await getSongDetailToId(id)\n    }\n    return {\n      hots,\n      onSelectHotItem,\n      searchList,\n      isHotShow,\n      keyWord,\n      scrollRef,\n      inputRef,\n      isLoading,\n      onClearKeyWord,\n      onFocusToInput,\n      onSelectItem\n\n    }\n  }\n}\n</script>\n\n<style scoped lang='scss'>\n.search-wrap {\n  position: fixed;\n  left: 0;\n  top: 176px;\n  bottom: 0;\n  right: 0;\n  z-index: 10;\n\n  .input-box {\n    width: 686px;\n    height: 66px;\n    display: flex;\n    align-items: center;\n    background: rgba(#ffffff, 0.1);\n    border-radius: 40px;\n    margin-top: 32px;\n    position: relative;\n    margin-bottom: 32px;\n\n    .icon-search {\n      width: 24px;\n      height: 24px;\n      @include bg-image('~@/assets/imgs/search');\n      background-size: cover;\n      position: absolute;\n      left: 32px;\n      @extend .center-v;\n    }\n\n    .icon-close {\n      width: 34px;\n      height: 34px;\n      @include bg-image('~@/assets/imgs/close_btn');\n      background-size: 30px;\n      background-position: center;\n      position: absolute;\n      right: 32px;\n      @extend .center-v;\n    }\n\n    input {\n      width: 100%;\n      height: 100%;\n      background: transparent;\n      outline: none;\n      border: none;\n      padding: 0 80px;\n      color: #fff;\n    }\n  }\n\n  .hot-word {\n    color: $color-sub;\n    font-size: $font-size-large;\n    display: flex;\n    flex-wrap: wrap;\n    padding-bottom: 34px;\n\n    .hot-item:first-of-type {\n      color: $color-light;\n    }\n\n    .hot-item {\n      padding: 16px 0;\n      margin-right: 32px;\n    }\n  }\n\n  .search-scroll-wrap {\n    width: 100%;\n    position: fixed;\n    left: 0;\n    top: 290px;\n    bottom: 0;\n    overflow: hidden;\n  }\n}\n</style>\n","import { useStore } from 'vuex'\nimport { getSongDetail } from '@/api'\nimport { parseLyric } from '@/tool/indxe'\n\nexport default function() {\n  const store = useStore()\n  const setSongs = (songs) => {\n    store.commit('setSongs', songs)\n  }\n  const setPlayState = (flag) => {\n    store.commit('setPlayState', flag)\n  }\n  const setCurrentIndex = (index) => {\n    store.commit('setCurrentIndex', index)\n  }\n  const setFullScreen = (flag) => {\n    store.commit('setFullScreen', flag)\n  }\n  const getMusic = async (id) => {\n    return await store.dispatch('getMusicNoEffect', id)\n  }\n  const getLyric = async (id) => {\n    return await store.dispatch('getLyric', id)\n  }\n  const getSongDetailToId = async (id) => {\n    setSongs([])\n    const obj = {}\n    const details = await getSongDetail({ ids: id })\n    const musicUrl = await getMusic(id)\n    const lyric = await getLyric(id)\n    const song = details.songs[0]\n    obj.name = song.name\n    obj.id = song.id\n    obj.singer = song.ar.map(item => item.name).join(' ') + ' - ' + song.al.name\n    obj.picUrl = song.al.picUrl\n    obj.musicUrl = musicUrl\n    obj.lyric = parseLyric(lyric)\n    setPlayState(false)\n    setSongs([obj])\n    setCurrentIndex(0)\n    setFullScreen(true)\n    setPlayState(true)\n  }\n  return {\n    getSongDetailToId\n  }\n}\n","import { render } from \"./Search.vue?vue&type=template&id=e2055aba&scoped=true\"\nimport script from \"./Search.vue?vue&type=script&lang=js\"\nexport * from \"./Search.vue?vue&type=script&lang=js\"\n\nimport \"./Search.vue?vue&type=style&index=0&id=e2055aba&scoped=true&lang=scss\"\n\nimport exportComponent from \"/Users/nmy/code/vue3-music/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-e2055aba\"]])\n\nexport default __exports__","<template>\n  <ul class='user-list-wrap'>\n    <li class='item' v-for='item in list' :key='item' @click='onSelectItem(item.id)'>\n      <div class='pic'>\n        <img v-if='item.picUrl' v-lazy='item.picUrl'>\n      </div>\n      <div class='desc'>\n        <h4 class='name'>{{ item.name }}</h4>\n        <h4 class='singer'>{{ item.singer }}</h4>\n      </div>\n    </li>\n    <mini-player-box v-if='isShowBottomBox'></mini-player-box>\n  </ul>\n</template>\n\n<script>\n\nimport MiniPlayerBox from '@/components/mini-player-box/mini-player-box'\n\nexport default {\n  name: 'user-list',\n  components: { MiniPlayerBox },\n  props: {\n    list: {\n      type: Array,\n      default: () => ([])\n    },\n    isShowBottomBox: {\n      type: Boolean,\n      default: true\n    }\n  },\n  setup(props, { emit }) {\n    const onSelectItem = (id) => {\n      emit('select', id)\n    }\n    return {\n      onSelectItem\n    }\n  }\n}\n</script>\n\n<style scoped lang='scss'>\n.user-list-wrap {\n  .item {\n    display: flex;\n    justify-content: space-between;\n    margin-top: 32px;\n\n    &:last-of-type {\n      padding-bottom: 32px;\n    }\n\n    .pic {\n      width: 120px;\n      height: 120px;\n      margin-right: 32px;\n      border-radius: 30px;\n      overflow: hidden;\n      box-shadow: 0px 12px 18px 0px rgba(22, 33, 42, 0.5);\n      flex-shrink: 0;\n      img {\n        height: 100%;\n        width: 100%;\n      }\n    }\n\n    .desc {\n      height: 120px;\n      margin-right: auto;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n\n      h4 {\n        margin: 10px 0;\n\n        &.name {\n          color: $color-light;\n          font-size: $font-size-medium;\n          @include clamp(1);\n          height: 24px;\n        }\n\n        &.singer {\n          color: $color-sub;\n          font-size: $font-size-medium;\n          @include clamp(1);\n        }\n      }\n    }\n  }\n}\n</style>\n","import { render } from \"./user-list.vue?vue&type=template&id=3c32307a&scoped=true\"\nimport script from \"./user-list.vue?vue&type=script&lang=js\"\nexport * from \"./user-list.vue?vue&type=script&lang=js\"\n\nimport \"./user-list.vue?vue&type=style&index=0&id=3c32307a&scoped=true&lang=scss\"\n\nimport exportComponent from \"/Users/nmy/code/vue3-music/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3c32307a\"]])\n\nexport default __exports__","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Search.vue?vue&type=style&index=0&id=e2055aba&scoped=true&lang=scss\""],"sourceRoot":""}